%% 使用切比雪夫多项式在区间[-4,0]上逼近exp(x)，大问题，应该是e^(-4,0)
% f(x) = c0/2 + sum(ck*Tk(x)); k = 1,2,...
% ck = 2/pi * integral(f(cos(theta)) * cos(k*theta)) d_theta; [0,pi]
% x = 2*t - 2;              t belongs to [-1,+1]
% t = x/2 + 1;

clear;clc;
syms theta
c0_half = (1/pi) * int( exp( (2*cos(theta) - 2) ),0,pi);
c0h_double = double(c0_half);

for k = 1:4

    c(k) = (2/pi) * int(cos(k*theta) * exp( (2*cos(theta) - 2) ) ,0,pi);
    c_double(k) = double(c(k));
    
end

% T0_x = 1;                             0.308508322553671
% T1_x = @(x) t;                        0.430538578497875
% T2_x = @(x) 2*t.^2 - 1;               0.186478066609467
% T3_x = @(x) 4*t.^3 - 3*t;             0.057582445278942
% T4_x = @(x) 8*t.^4 - 8*t.^2 + 1;      0.013730730772641

ft = @(t) 0.308508322553671 + 0.430538578497875 * t + 0.186478066609467 * (2*t.^2 - 1) ...
             + 0.057582445278942 * (4*t.^3 - 3*t) + 0.013730730772641 * (8*t.^4 - 8*t.^2 + 1);
         
t = linspace(-1,1,100);
exp_cheby = ft(t);

x = 2*t - 2; 
y = exp(x);

figure(1)
subplot(121),plot(x,exp_cheby,x,y);
legend('ft','original');
title('切比雪夫多项式逼近效果');
%%
syms t x

t = x/2 + 1;
ft =  0.308508322553671 + 0.430538578497875 * t + 0.186478066609467 * (2*t.^2 - 1) ...
     + 0.057582445278942 * (4*t.^3 - 3*t) + 0.013730730772641 * (8*t.^4 - 8*t.^2 + 1);
fx = expand(ft);
disp(fx);   
% (3957613695436199*x^4)/576460752303423488 + (24128959712987201*x^3)/288230376151711744 + (14530186022907717*x^2)/36028797018963968 + (275891888724585397*x)/288230376151711744 + 287319033124655641/288230376151711744
         
a0 = 287319033124655641/288230376151711744;     % 0.996838143712596
a1 = (275891888724585397)/288230376151711744;   % 0.957192272404239
a2 = (14530186022907717)/36028797018963968;     % 0.403293676867969
a3 = (24128959712987201)/288230376151711744;    % 0.083714145730035
a4 = (3957613695436199)/576460752303423488;     % 0.006865365386321   

x = linspace(-4,0,100);
y = exp(x);

gx = a0 + a1*x + a2*x.^2 + a3*x.^3 + a4*x.^4;

figure(1)
subplot(122),plot(x,gx,x,y);
legend('gx','original');
title('切比雪夫多项式逼近效果');

%%
x = linspace(-6,2,100);
y = exp(x);
gx = a0 + a1*x + a2*x.^2 + a3*x.^3 + a4*x.^4;

tl = -4 * ones(100,1);
tu = 0 * ones(100,1);
yl = linspace(-2,8,100);
yu = linspace(-2,8,100);

figure(2)
plot(x,gx,'-*r',x,y,'-ob');
hold on
plot(tl,yl,'--k',tu,yu,'--k','LineWidth',2);
axis([-6 2 0 8]);
grid on
legend('多项式','指数');
title('切比雪夫三阶多项式逼近效果');


