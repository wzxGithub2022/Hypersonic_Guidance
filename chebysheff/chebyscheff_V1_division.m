%% 使用切比雪夫多项式在区间[3,7]上逼近1/V
% sqrt(R0*g0)是313m/s，取[3,7]
% f(x) = c0/2 + sum(ck*Tk(x)); k = 1,2,...
% ck = 2/pi * integral(f(cos(theta)) * cos(k*theta)) d_theta; [0,pi]
% x = 2*t + 5;              t belongs to [-1,+1]
% t = x/2 - 2.5;

clear;clc;
syms theta
c0_half = (1/pi) * int( 1 / (2*cos(theta) + 5) ,0,pi);
c0h_double = double(c0_half);

for k = 1:4

    c(k) = (2/pi) * int(cos(k*theta) / (2*cos(theta) + 5) ,0,pi);
    c_double(k) = double(c(k));
    
end

% T0_x = 1;                             0.218217890235992
% T1_x = @(x) t;                        -0.091089451179962
% T2_x = @(x) 2*t.^2 - 1;               0.019011475427825
% T3_x = @(x) 4*t.^3 - 3*t;             -0.003967925959162
% T4_x = @(x) 8*t.^4 - 8*t.^2 + 1;      8.281543679849273e-04

ft = @(t) 0.218217890235992 - 0.091089451179962 * t + 0.019011475427825 * (2*t.^2 - 1) ...
             - 0.003967925959162 * (4*t.^3 - 3*t) + 8.281543679849273e-04 * (8*t.^4 - 8*t.^2 + 1);

t = linspace(-1,1,100);
division_cheby = ft(t);

x = 2*t + 5; 
y = 1./x;

figure(1)
subplot(121),plot(x,division_cheby,x,y);
legend('ft','original');
title('切比雪夫多项式逼近效果');

%%

syms t x

t = x/2 - 2.5;
ft = 0.218217890235992 - 0.091089451179962 * t + 0.019011475427825 * (2*t.^2 - 1) ...
     - 0.003967925959162 * (4*t.^3 - 3*t) + 8.281543679849273e-04 * (8*t.^4 - 8*t.^2 + 1);
fx = expand(ft);
disp(fx);
% (3819187919935659*x^4)/9223372036854775808 - (11835323383341957*x^3)/1152921504606846976 + (459879410875559877*x^2)/4611686018427387904 - (1092791902475660081*x)/2305843009213693952 + 21^(1/2)/21 + 8142486904116896413/9223372036854775808

a0 = 21^(1/2)/21 + 8142486904116896413/9223372036854775808;     % 1.101028089323823
a1 = - (1092791902475660081)/2305843009213693952;               % -0.473922941895471
a2 = (459879410875559877)/4611686018427387904;                  % 0.099720451270527
a3 = - (11835323383341957)/1152921504606846976;                 % -0.010265506659430
a4 = (3819187919935659)/9223372036854775808;                    % 4.140771839924636e-04

x = linspace(3,7,100);
y = 1./x;

gx = a0 + a1*x + a2*x.^2 + a3*x.^3 + a4*x.^4;

figure(1)
subplot(122),plot(x,gx,x,y);
legend('gx','original');
title('切比雪夫多项式逼近效果');

%%
x = linspace(1,9,100);
y = 1./x;
gx = a0 + a1*x + a2*x.^2 + a3*x.^3 + a4*x.^4;

tl = 3 * ones(100,1);
tu = 7 * ones(100,1);
yl = linspace(-2,8,100);
yu = linspace(-2,8,100);

figure(2)
plot(x,gx,'-*r',x,y,'-ob');
hold on
plot(tl,yl,'--k',tu,yu,'--k','LineWidth',2);
axis([1 9 0 1]);
grid on
legend('多项式','倒数');
title('切比雪夫三阶多项式逼近效果');
