%% 使用切比雪夫多项式在区间[-4,0]上逼近exp(-x)，大问题，应该是e^(-4,0)
% f(x) = c0/2 + sum(ck*Tk(x)); k = 1,2,...
% ck = 2/pi * integral(f(cos(theta)) * cos(k*theta)) d_theta; [0,pi]
% x = 2*t - 2;              t belongs to [-1,+1]
% t = x/2 + 1;

clear;clc;
syms theta
c0_half = (1/pi) * int( exp( -(2*cos(theta) - 2) ),0,pi);
c0h_double = double(c0_half);

for k = 1:4

    c(k) = (2/pi) * int(cos(k*theta) * exp( -(2*cos(theta) - 2) ) ,0,pi);
    c_double(k) = double(c(k));
    
end

% T0_x = 1;                             16.843983681258990
% T1_x = @(x) t;                        -23.506609903883646
% T2_x = @(x) 2*t.^2 - 1;               10.181357458634333
% T3_x = @(x) 4*t.^3 - 3*t;             -3.143894986614983
% T4_x = @(x) 8*t.^4 - 8*t.^2 + 1;      0.749672498789384

ft = @(t) 16.843983681258990 - 23.506609903883646 * t + 10.181357458634333 * (2*t.^2 - 1) ...
             - 3.143894986614983 * (4*t.^3 - 3*t) + 0.749672498789384 * (8*t.^4 - 8*t.^2 + 1);

t = linspace(-1,1,100);
exp_cheby = ft(t);

x = 2*t - 2; 
y = exp(-x);

figure(1)
subplot(121),plot(x,exp_cheby,x,y);
legend('ft','original');
title('切比雪夫多项式逼近效果');

%%

syms t x

t = x/2 + 1;
ft = 16.843983681258990 - 23.506609903883646 * t + 10.181357458634333 * (2*t.^2 - 1) ...
      - 3.143894986614983 * (4*t.^3 - 3*t) + 0.749672498789384 * (8*t.^4 - 8*t.^2 + 1);
fx = expand(ft);
disp(fx);
% (6752449572395557*x^4)/18014398509481984 + (3212738499842755*x^3)/2251799813685248 + (14212093819759861*x^2)/4503599627370496 + (258541811919699*x)/562949953421312 + 10128674358593349/9007199254740992

a0 = 10128674358593349/9007199254740992;     % 1.124508748184077
a1 = (258541811919699)/562949953421312;      % 0.459262515874491
a2 = (14212093819759861)/4503599627370496;   % 3.155718757366057
a3 = (3212738499842755)/2251799813685248;    % 1.426742501850045
a4 = (6752449572395557)/18014398509481984;   % 0.374836249394692

x = linspace(-4,0,100);
y = exp(-x);

gx = a0 + a1*x + a2*x.^2 + a3*x.^3 + a4*x.^4;

figure(1)
subplot(122),plot(x,gx,x,y);
legend('gx','original');
title('切比雪夫多项式逼近效果');


